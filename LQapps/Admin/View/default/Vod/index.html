<include file="Public:header" />
<style>.table-responsive.panel-body,.table>tbody>tr>td{overflow:visible;}</style>
<div class="col-xs-12 col-sm-9 col-lg-10"> 
  <include file="Public:common-current" />
  <form name="{$lq_form_list}" id="{$lq_form_list}" class="form-horizontal" onsubmit="return false">
  <input type="hidden" id="thinkphpurl" name="thinkphpurl" value="{$page_config.thinkphpurl}" />
  <input type="hidden" id="keymode" value="{$search_content.keymode}" />
  <input type="hidden" id="pagesize" value="{$search_content.pagesize}" />
  <div class="clearfix welcome-container">
  	<if condition="$os_lock.search eq '1'">  
    <include file="Public:common-search" />
    <else />
    {/* 在这里放特定搜索 */}
        <div class="panel panel-default" id="scroll" style="margin-top:20px;">
            <div class="panel-heading">
                统计概况
            </div>
            <style>
                .account-stat .account-stat-btn >  div{ width: 13.6%}
            </style>
            <div class="account-stat">
                <div class="account-stat-btn">
                    <div>录播申请<a href="{:U('index',array('status'=>4))}"><span id="vod_apply"> 0</span></a></div>
                    <!--<div>直播总量<span id="live_total">0</span></div>-->
                    <div>生效录播<a href="{:U('index',array('status'=>6))}"><span id="vod_effect">0</span></a></div>
                    <div>完结录播<a href="{:U('index',array('status'=>1))}"><span id="vod_finish">0</span></a></div>
                    <div>下架录播<a href="{:U('index',array('status'=>2))}"><span id="vod_closed">0</span></a></div>
                    <div>参与老师<a href="javascript:;"> <span id="teacher_total">0</span></a></div>
                    <div>参与学生<a href="javascript:;"> <span id="student_total">0</span></a></div>
                    <div>视频总数<a href="javascript:;"> <span id="vod_total">0</span></a></div>
                </div>
            </div>
        </div>

            <div class="clearfix">
              <div class="panel panel-info">
                <div class="panel-body" style="position:relative;">
                    <div class="lq-panel-body-title"><span class="btn"><i class="fa fa-paw"></i> 筛选</span></div>
                    
                    <div class="form-group">
                      <label class="col-xs-12 col-sm-2 col-md-2 col-lg-1 control-label">搜索</label>
                      <div class="col-sm-8 col-lg-10 col-xs-12">
                        <div class="input-group">
                          <input type="text" class="form-control" id="fkeyword" value="{$search_content.fkeyword}" placeholder="{$keywordDefault}" onclick="lqKeywordOnclick(this)" onblur="lqKeywordOnblur(this)"/>
                          <div class="input-group-btn">
                            <button class="btn btn-default" id="listSearch"><i class="fa fa-search"></i> 搜索</button>
                            <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-expanded="false"><span class="caret"></span></button>
                            <ul class="dropdown-menu dropdown-menu-right" role="menu">
                            <li><a href="javascript:;" onclick="$('#fkeyword').attr('placeholder','精准搜索：请输入关键字');$('#keymode').val(1);">精准搜索</a></li>
                            <li><a href="javascript:;" onclick="$('#fkeyword').attr('placeholder','模糊搜索：请输入关键字');$('#keymode').val(0);">模糊搜索</a></li>
                            </ul>
                          </div>
                        </div>
                      </div>
                    </div>
                    
 					<div class="form-group">
         		      <label class="col-xs-12 col-sm-2 col-md-2 col-lg-1 control-label">课程分类</label>
                      <div class="col-sm-8 col-lg-10 col-xs-12">
                      <div class="col-lg-6" style="padding:0px;"><select class="form-control" id="cat_id">{$zn_cat_id_str}</select></div>
                      <div class="col-lg-6"><select class="form-control" id="zl_status">{$recommend_str}</select></div>
                      </div>
                    </div>                   
                    
                </div>
              </div>
            </div>
			<script language="javascript">   
            $(function(){
				 //时间开启
				 $("#a_open_time").click(function(){	
				 		if($("#open_time").val()=="1"){
							$("#open_time").val("0");
							$(this).removeClass("btn-primary").addClass("btn-default");
						}else{
							$("#open_time").val("1");
							$(this).removeClass("btn-default").addClass("btn-primary");
						}
				 });
                //通用搜索
                $("#listSearch").click(function(){	
                    require(['layer'], function(){
						var fkeyword=$("#fkeyword").val();
						var cat_id=$("#cat_id").val();
						var status=$("#zl_status").val();
						var open_time=$("#open_time").val();
						if(fkeyword!='{$keywordDefault}'||cat_id||status||open_time==1){
							var searchurl=$("#thinkphpurl").val()+'index/s/';
							var urlpara="fkeyword/"+encodeURIComponent(fkeyword)+"/";
							urlpara+="keymode/"+encodeURIComponent($("#keymode").val())+"/";
							urlpara+="pagesize/"+encodeURIComponent($("#pagesize").val())+"/";
							urlpara+="open_time/"+encodeURIComponent($("#open_time").val())+"/";						
							urlpara+="time_start/"+encodeURIComponent($("#time_start").val())+"/";
							urlpara+="time_end/"+encodeURIComponent($("#time_end").val())+"/";	
							if(cat_id) urlpara+="cat_id/"+cat_id+"/";
							if(status) urlpara+="status/"+status+"/";
							location.href=searchurl+base64encode(urlpara);
						}else{
							layer.msg("请输入搜索条件！",{icon:5,time:2000});
						}					
                    });			
                });

                var url = '{:U("Vod/ajaxSearchData")}';
                $.post(url, function(data){
                    $("#vod_effect").html(data.vod_effect);
                    $("#vod_finish").html(data.vod_finish);
                    $("#vod_closed").html(data.vod_closed);
                    $("#vod_apply").html(data.vod_apply);
                    $("#teacher_total").html(data.teacher_total);
                    $("#student_total").html(data.student_total);
                    $("#vod_total").html(data.vod_total);
                })

            });
            </script> 
                
    </if> 
    <div class="row">
      <div class="clearfix template">
        <div class="panel panel-default">
		  <include file="Public:index-list-button" />
          
          <div class="table-responsive panel-body">
            <table class="table table-hover">
                 <thead>
                      <tr>
                        <th style="width:40px;"><input type="checkbox" class="checkbox" value="0" id="list_checkbox"></th>                      
                        <th style="width:80px;text-align:left;">序号/ID</th>
                          <th>标题</th>
                          <th style="width:130px;">老师(id)</th>
                        <th style="width:170px;" title="课程封面">课程封面</th>

                        <th style="width:180px;">课程分类</th>

                        <th style="width:150px;">预计课节	</th>
                        <th style="width:120px;">状态</th>
                        <!--<th style="width:100px;">设置状态</th>-->

                        <th style="width:150px;text-align:center;"><a href="javascript:;" id="op_msg">{:L("LABEL_OS")}?</a></th>
                      </tr>
                </thead>             
              
              <tbody id="list-tbody">
                  <volist name="list" id="data" key="key" empty="$empty_msg">
                    <tr id="{$data.id}" visible="{$data.zl_visible}" opCheck='0'>
                      <td><input type="checkbox" class="checkbox" value="{$data.id}" name="items" /></td>
                      <td align="left">{$data.no}/{$data.id}</td>
                        <td edit="0" op="label" title="{:L('ALT_BUTTON_EDIT_LABEL')}">{$data.zc_title}</td>
                        <td>{$data.zc_teacher_label}</td>
                      <td class="imgtd"><img src="{$data.image}" alt="{$data.zc_title}" height="60"/></td>
                      <td>{$data.zn_cat_id_label}</td>
                      <td>{$data.zc_expect_lesson}</td>

                      <!--<td>-->
                      <!--<a href="javascript:void(0);" op="is_index" val="{$data.zl_is_index}">{$data.zl_is_index_label}</a>-->
                      <!--<a href="javascript:void(0);" op="is_good" val="{$data.zl_is_good}">{$data.zl_is_good_label}</a>-->
                      <!--</td>                     -->
                      <td class="status">{$data.status_label}</td>
                        <!--<td><div class="btn-group">-->
                            <!--<button type="button" data-toggle="dropdown" id="os_button"> <i class="fa fa-chevron-down"></i> 状态设置 </button>-->
                            <!--<ul class="dropdown-menu slidedown">-->
                                <!--<volist name="data.set_arr" id="set_arr">-->
                                    <!--<li><a href="javascript:void(0);" op="set_status" val="{$i}">{$set_arr}</a></li>-->
                                <!--</volist>-->
                            <!--</ul>-->
                        <!--</div></td>-->
                      <td class="manage-menu list-os-a">
                      <a href="__CONTROLLER__/edit/tnid/{$data.id}" title="{:L("LABEL_OS_EDITID")}[{$data.id}]"><i class="fa fa-edit"></i></a>
             		  <a href="javascript:jumpUrl({$data.id})" title="{:L("LABEL_RELATION")}[{$data.id}]"><i class="fa fa-puzzle-piece"></i></a>

                          <a href="javascript:;" class="opDelete" title="{:L("LABEL_OS_TITLE_DEL")}[{$data.zc_title}]"><i class="fa fa-times-circle"></i></a>
                      </td>
                    </tr>
                  </volist>
              </tbody>
            </table>
          </div>
        </div>
        {$page} 
      </div>
    </div>
  </div>
  </form>
  
</div>
<script>
    $(document).ready(function(){
        $('tbody>tr>td a[op]').click(function(){util.ajaxPropertyB($(this),'__APP__/Live');});//单项属性切换
    });
    function jumpUrl(id)
    {
        var urlpara =base64encode("cat_id/"+id+"/");
        window.location.href = "__APP__/LessonVod/index/s/"+urlpara;
    }
</script>
<include file="Public:footer" />
